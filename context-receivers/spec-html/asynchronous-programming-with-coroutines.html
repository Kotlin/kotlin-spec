<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Marat Akhin" />
  <meta name="author" content="Mikhail Belyaev" />
  <title>Kotlin language specification</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="./resources/css/main.css">
  <link rel="stylesheet" href="./resources/js/katex/katex.min.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script type="text/javascript">
      var require = {
          baseUrl: "resources/js",
          urlArgs : "v=3"
      };
  </script>
  <script data-main="main" src="https://requirejs.org/docs/release/2.3.6/minified/require.js"></script>
  
  <link rel="Shortcut Icon" href="https://kotlinlang.org/assets/images/favicon.ico" type="image/x-icon"/>
  <link rel="apple-touch-icon" href="https://kotlinlang.org/assets/images/apple-touch-icon.png"/>
  <link rel="apple-touch-icon" sizes="72x72" href="https://kotlinlang.org/assets/images/apple-touch-icon-72x72.png"/>
  <link rel="apple-touch-icon" sizes="114x114" href="https://kotlinlang.org/assets/images/apple-touch-icon-114x114.png"/>
  <link rel="apple-touch-icon" sizes="144x144" href="https://kotlinlang.org/assets/images/apple-touch-icon-144x144.png"/>
  
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5P98');</script>
  <!-- End Google Tag Manager -->
</head>
<body>
<div class="header-bar">
    <div class="icon-menu">
        <span class="divide"></span>
        <span class="divide"></span>
        <span class="divide"></span>
    </div>
    <a class="main-page" href="http://kotlinlang.org">Kotlin</a>
    <a href="./pdf/kotlin-spec.pdf" target="_blank" class="download-full-pdf">
        Download PDF
    </a>
</div>
<div class="toc-bar">
    <div class="toc-header">
        <div>Table of contents</div>
        <input id="toc-search-bar" placeholder="Search..." title="Currently, only exact matches are supported">
    </div>
    <div class="toc-body empty"></div>
</div>
<header>
<h1 class="title">Kotlin language specification</h1>
<p class="subtitle">Version 1.5-rfc+0.1</p>
<p class="author">Marat Akhin</p>
<p class="author">Mikhail Belyaev</p>
</header>





























<div id="TOC">
<ul>
<li><a href="kotlincore.pdf#kotlincore" id="toc-element-kotlincore" class="toc-element">Kotlin/Core</a>
<ul>
<li><a href="introduction.pdf#introduction" id="toc-element-introduction" class="toc-element unnumbered">Introduction</a>
<ul>
<li><a href="introduction.pdf#compatibility" id="toc-element-compatibility" class="toc-element unnumbered">Compatibility</a></li>
<li><a href="introduction.pdf#experimental-features" id="toc-element-experimental-features" class="toc-element unnumbered">Experimental features</a></li>
<li><a href="introduction.pdf#acknowledgments" id="toc-element-acknowledgments" class="toc-element unnumbered">Acknowledgments</a></li>
<li><a href="introduction.pdf#feedback" id="toc-element-feedback" class="toc-element unnumbered">Feedback</a></li>
<li><a href="introduction.pdf#reference" id="toc-element-reference" class="toc-element unnumbered">Reference</a></li>
</ul></li>
<li><a href="syntax-and-grammar.pdf#syntax-and-grammar" id="toc-element-syntax-and-grammar" class="toc-element">Syntax and grammar</a>
<ul>
<li><a href="syntax-and-grammar.pdf#lexical-grammar" id="toc-element-lexical-grammar" class="toc-element">Lexical grammar</a>
<ul>
<li><a href="syntax-and-grammar.pdf#whitespace-and-comments" id="toc-element-whitespace-and-comments" class="toc-element">Whitespace and comments</a></li>
<li><a href="syntax-and-grammar.pdf#keywords-and-operators" id="toc-element-keywords-and-operators" class="toc-element">Keywords and operators</a></li>
<li><a href="syntax-and-grammar.pdf#literals" id="toc-element-literals" class="toc-element">Literals</a></li>
<li><a href="syntax-and-grammar.pdf#identifiers" id="toc-element-identifiers" class="toc-element">Identifiers</a></li>
<li><a href="syntax-and-grammar.pdf#string-mode-grammar" id="toc-element-string-mode-grammar" class="toc-element">String mode grammar</a></li>
<li><a href="syntax-and-grammar.pdf#tokens" id="toc-element-tokens" class="toc-element">Tokens</a></li>
</ul></li>
<li><a href="syntax-and-grammar.pdf#syntax-grammar" id="toc-element-syntax-grammar" class="toc-element">Syntax grammar</a></li>
<li><a href="syntax-and-grammar.pdf#documentation-comments" id="toc-element-documentation-comments" class="toc-element">Documentation comments</a></li>
</ul></li>
<li><a href="type-system.pdf#type-system" id="toc-element-type-system" class="toc-element">Type system</a>
<ul>
<li><a href="type-system.pdf#glossary" id="toc-element-glossary" class="toc-element unnumbered">Glossary</a></li>
<li><a href="type-system.pdf#introduction-1" id="toc-element-introduction-1" class="toc-element unnumbered">Introduction</a></li>
<li><a href="type-system.pdf#type-kinds" id="toc-element-type-kinds" class="toc-element">Type kinds</a>
<ul>
<li><a href="type-system.pdf#built-in-types" id="toc-element-built-in-types" class="toc-element">Built-in types</a>
<ul>
<li><a href="type-system.pdf#kotlin.any-typesystem" id="toc-element-kotlin.any-typesystem" class="toc-element"><code>kotlin.Any</code></a></li>
<li><a href="type-system.pdf#kotlin.nothing-typesystem" id="toc-element-kotlin.nothing-typesystem" class="toc-element"><code>kotlin.Nothing</code></a></li>
<li><a href="type-system.pdf#kotlin.function-typesystem" id="toc-element-kotlin.function-typesystem" class="toc-element"><code>kotlin.Function</code></a></li>
<li><a href="type-system.pdf#built-in-integer-types-typesystem" id="toc-element-built-in-integer-types-typesystem" class="toc-element">Built-in integer types</a></li>
<li><a href="type-system.pdf#array-types" id="toc-element-array-types" class="toc-element">Array types</a></li>
</ul></li>
<li><a href="type-system.pdf#classifier-types" id="toc-element-classifier-types" class="toc-element">Classifier types</a>
<ul>
<li><a href="type-system.pdf#simple-classifier-types" id="toc-element-simple-classifier-types" class="toc-element">Simple classifier types</a></li>
<li><a href="type-system.pdf#parameterized-classifier-types" id="toc-element-parameterized-classifier-types" class="toc-element">Parameterized classifier types</a></li>
</ul></li>
<li><a href="type-system.pdf#type-parameters" id="toc-element-type-parameters" class="toc-element">Type parameters</a>
<ul>
<li><a href="type-system.pdf#function-type-parameters" id="toc-element-function-type-parameters" class="toc-element">Function type parameters</a></li>
<li><a href="type-system.pdf#mixed-site-variance" id="toc-element-mixed-site-variance" class="toc-element">Mixed-site variance</a></li>
<li><a href="type-system.pdf#declaration-site-variance" id="toc-element-declaration-site-variance" class="toc-element">Declaration-site variance</a></li>
<li><a href="type-system.pdf#use-site-variance" id="toc-element-use-site-variance" class="toc-element">Use-site variance</a></li>
</ul></li>
<li><a href="type-system.pdf#type-capturing" id="toc-element-type-capturing" class="toc-element">Type capturing</a></li>
<li><a href="type-system.pdf#type-containment" id="toc-element-type-containment" class="toc-element">Type containment</a></li>
<li><a href="type-system.pdf#function-types" id="toc-element-function-types" class="toc-element">Function types</a>
<ul>
<li><a href="type-system.pdf#suspending-function-types" id="toc-element-suspending-function-types" class="toc-element">Suspending function types</a></li>
</ul></li>
<li><a href="type-system.pdf#flexible-types" id="toc-element-flexible-types" class="toc-element">Flexible types</a>
<ul>
<li><a href="type-system.pdf#dynamic-type" id="toc-element-dynamic-type" class="toc-element">Dynamic type</a></li>
<li><a href="type-system.pdf#platform-types" id="toc-element-platform-types" class="toc-element">Platform types</a></li>
</ul></li>
<li><a href="type-system.pdf#nullable-types" id="toc-element-nullable-types" class="toc-element">Nullable types</a>
<ul>
<li><a href="type-system.pdf#nullability-lozenge" id="toc-element-nullability-lozenge" class="toc-element">Nullability lozenge</a></li>
</ul></li>
<li><a href="type-system.pdf#intersection-types" id="toc-element-intersection-types" class="toc-element">Intersection types</a></li>
<li><a href="type-system.pdf#integer-literal-types" id="toc-element-integer-literal-types" class="toc-element">Integer literal types</a></li>
<li><a href="type-system.pdf#union-types" id="toc-element-union-types" class="toc-element">Union types</a></li>
</ul></li>
<li><a href="type-system.pdf#type-contexts-and-scopes" id="toc-element-type-contexts-and-scopes" class="toc-element">Type contexts and scopes</a>
<ul>
<li><a href="type-system.pdf#inner-and-nested-type-contexts" id="toc-element-inner-and-nested-type-contexts" class="toc-element">Inner and nested type contexts</a></li>
</ul></li>
<li><a href="type-system.pdf#subtyping" id="toc-element-subtyping" class="toc-element">Subtyping</a>
<ul>
<li><a href="type-system.pdf#subtyping-rules" id="toc-element-subtyping-rules" class="toc-element">Subtyping rules</a></li>
<li><a href="type-system.pdf#subtyping-for-flexible-types" id="toc-element-subtyping-for-flexible-types" class="toc-element">Subtyping for flexible types</a></li>
<li><a href="type-system.pdf#subtyping-for-intersection-types" id="toc-element-subtyping-for-intersection-types" class="toc-element">Subtyping for intersection types</a></li>
<li><a href="type-system.pdf#subtyping-for-integer-literal-types" id="toc-element-subtyping-for-integer-literal-types" class="toc-element">Subtyping for integer literal types</a></li>
<li><a href="type-system.pdf#subtyping-for-nullable-types" id="toc-element-subtyping-for-nullable-types" class="toc-element">Subtyping for nullable types</a></li>
</ul></li>
<li><a href="type-system.pdf#upper-and-lower-bounds" id="toc-element-upper-and-lower-bounds" class="toc-element">Upper and lower bounds</a>
<ul>
<li><a href="type-system.pdf#least-upper-bound" id="toc-element-least-upper-bound" class="toc-element">Least upper bound</a></li>
<li><a href="type-system.pdf#greatest-lower-bound" id="toc-element-greatest-lower-bound" class="toc-element">Greatest lower bound</a></li>
</ul></li>
<li><a href="type-system.pdf#type-approximation" id="toc-element-type-approximation" class="toc-element">Type approximation</a></li>
<li><a href="type-system.pdf#type-decaying" id="toc-element-type-decaying" class="toc-element">Type decaying</a></li>
<li><a href="type-system.pdf#references" id="toc-element-references" class="toc-element unnumbered">References</a></li>
</ul></li>
<li><a href="built-in-types-and-their-semantics.pdf#built-in-types-and-their-semantics" id="toc-element-built-in-types-and-their-semantics" class="toc-element">Built-in types and their semantics</a>
<ul>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.any-builtins" id="toc-element-kotlin.any-builtins" class="toc-element"><code>kotlin.Any</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.nothing-builtins" id="toc-element-kotlin.nothing-builtins" class="toc-element"><code>kotlin.Nothing</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.unit" id="toc-element-kotlin.unit" class="toc-element"><code>kotlin.Unit</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.boolean" id="toc-element-kotlin.boolean" class="toc-element"><code>kotlin.Boolean</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#built-in-integer-types-builtins" id="toc-element-built-in-integer-types-builtins" class="toc-element">Built-in integer types</a>
<ul>
<li><a href="built-in-types-and-their-semantics.pdf#integer-type-widening" id="toc-element-integer-type-widening" class="toc-element">Integer type widening</a></li>
</ul></li>
<li><a href="built-in-types-and-their-semantics.pdf#built-in-floating-point-arithmetic-types" id="toc-element-built-in-floating-point-arithmetic-types" class="toc-element">Built-in floating point arithmetic types</a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.char" id="toc-element-kotlin.char" class="toc-element"><code>kotlin.Char</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.string" id="toc-element-kotlin.string" class="toc-element"><code>kotlin.String</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.enum" id="toc-element-kotlin.enum" class="toc-element"><code>kotlin.Enum</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#built-in-array-types" id="toc-element-built-in-array-types" class="toc-element">Built-in array types</a>
<ul>
<li><a href="built-in-types-and-their-semantics.pdf#specialized-array-types" id="toc-element-specialized-array-types" class="toc-element">Specialized array types</a></li>
</ul></li>
<li><a href="built-in-types-and-their-semantics.pdf#iterator-types" id="toc-element-iterator-types" class="toc-element">Iterator types</a>
<ul>
<li><a href="built-in-types-and-their-semantics.pdf#specialized-iterator-types" id="toc-element-specialized-iterator-types" class="toc-element">Specialized iterator types</a></li>
</ul></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.throwable" id="toc-element-kotlin.throwable" class="toc-element"><code>kotlin.Throwable</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.comparable" id="toc-element-kotlin.comparable" class="toc-element"><code>kotlin.Comparable</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.function-builtins" id="toc-element-kotlin.function-builtins" class="toc-element"><code>kotlin.Function</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#built-in-annotation-types" id="toc-element-built-in-annotation-types" class="toc-element">Built-in annotation types</a></li>
<li><a href="built-in-types-and-their-semantics.pdf#reflection-support-builtin-types" id="toc-element-reflection-support-builtin-types" class="toc-element">Reflection support builtin types</a>
<ul>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.reflect.kclass" id="toc-element-kotlin.reflect.kclass" class="toc-element"><code>kotlin.reflect.KClass</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.reflect.kcallable" id="toc-element-kotlin.reflect.kcallable" class="toc-element"><code>kotlin.reflect.KCallable</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.reflect.kproperty" id="toc-element-kotlin.reflect.kproperty" class="toc-element"><code>kotlin.reflect.KProperty</code></a></li>
<li><a href="built-in-types-and-their-semantics.pdf#kotlin.reflect.kfunction" id="toc-element-kotlin.reflect.kfunction" class="toc-element"><code>kotlin.reflect.KFunction</code></a></li>
</ul></li>
</ul></li>
<li><a href="declarations.pdf#declarations" id="toc-element-declarations" class="toc-element">Declarations</a>
<ul>
<li><a href="declarations.pdf#glossary-1" id="toc-element-glossary-1" class="toc-element unnumbered">Glossary</a></li>
<li><a href="declarations.pdf#introduction-2" id="toc-element-introduction-2" class="toc-element unnumbered">Introduction</a></li>
<li><a href="declarations.pdf#classifier-declaration" id="toc-element-classifier-declaration" class="toc-element">Classifier declaration</a>
<ul>
<li><a href="declarations.pdf#class-declaration" id="toc-element-class-declaration" class="toc-element">Class declaration</a>
<ul>
<li><a href="declarations.pdf#constructor-declaration" id="toc-element-constructor-declaration" class="toc-element">Constructor declaration</a></li>
<li><a href="declarations.pdf#nested-and-inner-classifiers" id="toc-element-nested-and-inner-classifiers" class="toc-element">Nested and inner classifiers</a></li>
<li><a href="declarations.pdf#inheritance-delegation" id="toc-element-inheritance-delegation" class="toc-element">Inheritance delegation</a></li>
<li><a href="declarations.pdf#abstract-classes-declarations" id="toc-element-abstract-classes-declarations" class="toc-element">Abstract classes</a></li>
</ul></li>
<li><a href="declarations.pdf#data-class-declaration" id="toc-element-data-class-declaration" class="toc-element">Data class declaration</a></li>
<li><a href="declarations.pdf#enum-class-declaration" id="toc-element-enum-class-declaration" class="toc-element">Enum class declaration</a></li>
<li><a href="declarations.pdf#annotation-class-declaration" id="toc-element-annotation-class-declaration" class="toc-element">Annotation class declaration</a></li>
<li><a href="declarations.pdf#value-class-declaration" id="toc-element-value-class-declaration" class="toc-element">Value class declaration</a></li>
<li><a href="declarations.pdf#interface-declaration" id="toc-element-interface-declaration" class="toc-element">Interface declaration</a>
<ul>
<li><a href="declarations.pdf#functional-interface-declaration" id="toc-element-functional-interface-declaration" class="toc-element">Functional interface declaration</a></li>
</ul></li>
<li><a href="declarations.pdf#object-declaration" id="toc-element-object-declaration" class="toc-element">Object declaration</a></li>
<li><a href="declarations.pdf#local-class-declaration" id="toc-element-local-class-declaration" class="toc-element">Local class declaration</a></li>
<li><a href="declarations.pdf#classifier-initialization" id="toc-element-classifier-initialization" class="toc-element">Classifier initialization</a></li>
</ul></li>
<li><a href="declarations.pdf#function-declaration" id="toc-element-function-declaration" class="toc-element">Function declaration</a>
<ul>
<li><a href="declarations.pdf#function-signature" id="toc-element-function-signature" class="toc-element">Function signature</a></li>
<li><a href="declarations.pdf#named-positional-and-default-parameters" id="toc-element-named-positional-and-default-parameters" class="toc-element">Named, positional and default parameters</a></li>
<li><a href="declarations.pdf#variable-length-parameters" id="toc-element-variable-length-parameters" class="toc-element">Variable length parameters</a></li>
<li><a href="declarations.pdf#extension-function-declaration" id="toc-element-extension-function-declaration" class="toc-element">Extension function declaration</a></li>
<li><a href="declarations.pdf#contextual-function-declaration" id="toc-element-contextual-function-declaration" class="toc-element">Contextual function declaration</a></li>
<li><a href="declarations.pdf#inlining" id="toc-element-inlining" class="toc-element">Inlining</a></li>
<li><a href="declarations.pdf#tail-recursion-optimization" id="toc-element-tail-recursion-optimization" class="toc-element">Tail recursion optimization</a></li>
</ul></li>
<li><a href="declarations.pdf#property-declaration" id="toc-element-property-declaration" class="toc-element">Property declaration</a>
<ul>
<li><a href="declarations.pdf#read-only-property-declaration" id="toc-element-read-only-property-declaration" class="toc-element">Read-only property declaration</a></li>
<li><a href="declarations.pdf#mutable-property-declaration" id="toc-element-mutable-property-declaration" class="toc-element">Mutable property declaration</a></li>
<li><a href="declarations.pdf#local-property-declaration" id="toc-element-local-property-declaration" class="toc-element">Local property declaration</a></li>
<li><a href="declarations.pdf#getters-and-setters" id="toc-element-getters-and-setters" class="toc-element">Getters and setters</a></li>
<li><a href="declarations.pdf#delegated-property-declaration" id="toc-element-delegated-property-declaration" class="toc-element">Delegated property declaration</a></li>
<li><a href="declarations.pdf#extension-property-declaration" id="toc-element-extension-property-declaration" class="toc-element">Extension property declaration</a></li>
<li><a href="declarations.pdf#property-initialization" id="toc-element-property-initialization" class="toc-element">Property initialization</a></li>
<li><a href="declarations.pdf#constant-properties" id="toc-element-constant-properties" class="toc-element">Constant properties</a></li>
<li><a href="declarations.pdf#late-initialized-properties" id="toc-element-late-initialized-properties" class="toc-element">Late-initialized properties</a></li>
</ul></li>
<li><a href="declarations.pdf#type-alias" id="toc-element-type-alias" class="toc-element">Type alias</a></li>
<li><a href="declarations.pdf#declarations-with-type-parameters" id="toc-element-declarations-with-type-parameters" class="toc-element">Declarations with type parameters</a>
<ul>
<li><a href="declarations.pdf#type-parameter-variance" id="toc-element-type-parameter-variance" class="toc-element">Type parameter variance</a></li>
<li><a href="declarations.pdf#reified-type-parameters" id="toc-element-reified-type-parameters" class="toc-element">Reified type parameters</a></li>
</ul></li>
<li><a href="declarations.pdf#declaration-visibility" id="toc-element-declaration-visibility" class="toc-element">Declaration visibility</a></li>
</ul></li>
<li><a href="inheritance.pdf#inheritance" id="toc-element-inheritance" class="toc-element">Inheritance</a>
<ul>
<li><a href="inheritance.pdf#classifier-type-inheritance" id="toc-element-classifier-type-inheritance" class="toc-element">Classifier type inheritance</a>
<ul>
<li><a href="inheritance.pdf#abstract-classes-inheritance" id="toc-element-abstract-classes-inheritance" class="toc-element">Abstract classes</a></li>
<li><a href="inheritance.pdf#sealed-classes-and-interfaces" id="toc-element-sealed-classes-and-interfaces" class="toc-element">Sealed classes and interfaces</a></li>
<li><a href="inheritance.pdf#inheritance-from-built-in-types" id="toc-element-inheritance-from-built-in-types" class="toc-element">Inheritance from built-in types</a></li>
</ul></li>
<li><a href="inheritance.pdf#overriding" id="toc-element-overriding" class="toc-element">Overriding</a></li>
</ul></li>
<li><a href="scopes-and-identifiers.pdf#scopes-and-identifiers" id="toc-element-scopes-and-identifiers" class="toc-element">Scopes and identifiers</a>
<ul>
<li><a href="scopes-and-identifiers.pdf#linked-scopes" id="toc-element-linked-scopes" class="toc-element">Linked scopes</a></li>
<li><a href="scopes-and-identifiers.pdf#identifiers-and-paths" id="toc-element-identifiers-and-paths" class="toc-element">Identifiers and paths</a></li>
<li><a href="scopes-and-identifiers.pdf#labels" id="toc-element-labels" class="toc-element">Labels</a></li>
</ul></li>
<li><a href="statements.pdf#statements" id="toc-element-statements" class="toc-element">Statements</a>
<ul>
<li><a href="statements.pdf#assignments" id="toc-element-assignments" class="toc-element">Assignments</a>
<ul>
<li><a href="statements.pdf#simple-assignments" id="toc-element-simple-assignments" class="toc-element">Simple assignments</a></li>
<li><a href="statements.pdf#operator-assignments" id="toc-element-operator-assignments" class="toc-element">Operator assignments</a></li>
<li><a href="statements.pdf#safe-assignments" id="toc-element-safe-assignments" class="toc-element">Safe assignments</a></li>
</ul></li>
<li><a href="statements.pdf#loop-statements" id="toc-element-loop-statements" class="toc-element">Loop statements</a>
<ul>
<li><a href="statements.pdf#while-loop-statements" id="toc-element-while-loop-statements" class="toc-element">While-loop statements</a></li>
<li><a href="statements.pdf#do-while-loop-statements" id="toc-element-do-while-loop-statements" class="toc-element">Do-while-loop statements</a></li>
<li><a href="statements.pdf#for-loop-statements" id="toc-element-for-loop-statements" class="toc-element">For-loop statements</a></li>
</ul></li>
<li><a href="statements.pdf#code-blocks" id="toc-element-code-blocks" class="toc-element">Code blocks</a>
<ul>
<li><a href="statements.pdf#coercion-to-kotlin.unit" id="toc-element-coercion-to-kotlin.unit" class="toc-element">Coercion to <code>kotlin.Unit</code></a></li>
</ul></li>
</ul></li>
<li><a href="expressions.pdf#expressions" id="toc-element-expressions" class="toc-element">Expressions</a>
<ul>
<li><a href="expressions.pdf#glossary-2" id="toc-element-glossary-2" class="toc-element unnumbered">Glossary</a></li>
<li><a href="expressions.pdf#introduction-3" id="toc-element-introduction-3" class="toc-element unnumbered">Introduction</a></li>
<li><a href="expressions.pdf#constant-literals" id="toc-element-constant-literals" class="toc-element">Constant literals</a>
<ul>
<li><a href="expressions.pdf#boolean-literals" id="toc-element-boolean-literals" class="toc-element">Boolean literals</a></li>
<li><a href="expressions.pdf#integer-literals" id="toc-element-integer-literals" class="toc-element">Integer literals</a>
<ul>
<li><a href="expressions.pdf#decimal-integer-literals" id="toc-element-decimal-integer-literals" class="toc-element">Decimal integer literals</a></li>
<li><a href="expressions.pdf#hexadecimal-integer-literals" id="toc-element-hexadecimal-integer-literals" class="toc-element">Hexadecimal integer literals</a></li>
<li><a href="expressions.pdf#binary-integer-literals" id="toc-element-binary-integer-literals" class="toc-element">Binary integer literals</a></li>
</ul></li>
<li><a href="expressions.pdf#the-types-for-integer-literals" id="toc-element-the-types-for-integer-literals" class="toc-element">The types for integer literals</a></li>
<li><a href="expressions.pdf#real-literals" id="toc-element-real-literals" class="toc-element">Real literals</a></li>
<li><a href="expressions.pdf#character-literals" id="toc-element-character-literals" class="toc-element">Character literals</a>
<ul>
<li><a href="expressions.pdf#escaped-characters" id="toc-element-escaped-characters" class="toc-element">Escaped characters</a></li>
</ul></li>
<li><a href="expressions.pdf#string-literals" id="toc-element-string-literals" class="toc-element">String literals</a></li>
<li><a href="expressions.pdf#null-literal" id="toc-element-null-literal" class="toc-element">Null literal</a></li>
</ul></li>
<li><a href="expressions.pdf#string-interpolation-expressions" id="toc-element-string-interpolation-expressions" class="toc-element">String interpolation expressions</a></li>
<li><a href="expressions.pdf#try-expressions" id="toc-element-try-expressions" class="toc-element">Try-expressions</a></li>
<li><a href="expressions.pdf#conditional-expressions" id="toc-element-conditional-expressions" class="toc-element">Conditional expressions</a></li>
<li><a href="expressions.pdf#when-expressions" id="toc-element-when-expressions" class="toc-element">When expressions</a>
<ul>
<li><a href="expressions.pdf#exhaustive-when-expressions" id="toc-element-exhaustive-when-expressions" class="toc-element">Exhaustive when expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#logical-disjunction-expressions" id="toc-element-logical-disjunction-expressions" class="toc-element">Logical disjunction expressions</a></li>
<li><a href="expressions.pdf#logical-conjunction-expressions" id="toc-element-logical-conjunction-expressions" class="toc-element">Logical conjunction expressions</a></li>
<li><a href="expressions.pdf#equality-expressions" id="toc-element-equality-expressions" class="toc-element">Equality expressions</a>
<ul>
<li><a href="expressions.pdf#reference-equality-expressions" id="toc-element-reference-equality-expressions" class="toc-element">Reference equality expressions</a></li>
<li><a href="expressions.pdf#value-equality-expressions" id="toc-element-value-equality-expressions" class="toc-element">Value equality expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#comparison-expressions" id="toc-element-comparison-expressions" class="toc-element">Comparison expressions</a></li>
<li><a href="expressions.pdf#type-checking-and-containment-checking-expressions" id="toc-element-type-checking-and-containment-checking-expressions" class="toc-element">Type-checking and containment-checking expressions</a>
<ul>
<li><a href="expressions.pdf#type-checking-expressions" id="toc-element-type-checking-expressions" class="toc-element">Type-checking expressions</a></li>
<li><a href="expressions.pdf#containment-checking-expressions" id="toc-element-containment-checking-expressions" class="toc-element">Containment-checking expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#elvis-operator-expressions" id="toc-element-elvis-operator-expressions" class="toc-element">Elvis operator expressions</a></li>
<li><a href="expressions.pdf#range-expressions" id="toc-element-range-expressions" class="toc-element">Range expressions</a></li>
<li><a href="expressions.pdf#additive-expressions" id="toc-element-additive-expressions" class="toc-element">Additive expressions</a></li>
<li><a href="expressions.pdf#multiplicative-expressions" id="toc-element-multiplicative-expressions" class="toc-element">Multiplicative expressions</a></li>
<li><a href="expressions.pdf#cast-expressions" id="toc-element-cast-expressions" class="toc-element">Cast expressions</a></li>
<li><a href="expressions.pdf#prefix-expressions" id="toc-element-prefix-expressions" class="toc-element">Prefix expressions</a>
<ul>
<li><a href="expressions.pdf#annotated-expressions" id="toc-element-annotated-expressions" class="toc-element">Annotated expressions</a></li>
<li><a href="expressions.pdf#prefix-increment-expressions" id="toc-element-prefix-increment-expressions" class="toc-element">Prefix increment expressions</a></li>
<li><a href="expressions.pdf#prefix-decrement-expressions" id="toc-element-prefix-decrement-expressions" class="toc-element">Prefix decrement expressions</a></li>
<li><a href="expressions.pdf#unary-minus-expressions" id="toc-element-unary-minus-expressions" class="toc-element">Unary minus expressions</a></li>
<li><a href="expressions.pdf#unary-plus-expressions" id="toc-element-unary-plus-expressions" class="toc-element">Unary plus expressions</a></li>
<li><a href="expressions.pdf#logical-not-expressions" id="toc-element-logical-not-expressions" class="toc-element">Logical not expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#postfix-operator-expressions" id="toc-element-postfix-operator-expressions" class="toc-element">Postfix operator expressions</a>
<ul>
<li><a href="expressions.pdf#postfix-increment-expressions" id="toc-element-postfix-increment-expressions" class="toc-element">Postfix increment expressions</a></li>
<li><a href="expressions.pdf#postfix-decrement-expressions" id="toc-element-postfix-decrement-expressions" class="toc-element">Postfix decrement expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#not-null-assertion-expressions" id="toc-element-not-null-assertion-expressions" class="toc-element">Not-null assertion expressions</a></li>
<li><a href="expressions.pdf#indexing-expressions" id="toc-element-indexing-expressions" class="toc-element">Indexing expressions</a></li>
<li><a href="expressions.pdf#call-and-property-access-expressions" id="toc-element-call-and-property-access-expressions" class="toc-element">Call and property access expressions</a>
<ul>
<li><a href="expressions.pdf#navigation-operators" id="toc-element-navigation-operators" class="toc-element">Navigation operators</a></li>
<li><a href="expressions.pdf#callable-references" id="toc-element-callable-references" class="toc-element">Callable references</a></li>
<li><a href="expressions.pdf#class-literals" id="toc-element-class-literals" class="toc-element">Class literals</a></li>
<li><a href="expressions.pdf#function-calls-and-property-access" id="toc-element-function-calls-and-property-access" class="toc-element">Function calls and property access</a></li>
<li><a href="expressions.pdf#spread-operator-expressions" id="toc-element-spread-operator-expressions" class="toc-element">Spread operator expressions</a></li>
</ul></li>
<li><a href="expressions.pdf#function-literals" id="toc-element-function-literals" class="toc-element">Function literals</a>
<ul>
<li><a href="expressions.pdf#anonymous-function-declarations" id="toc-element-anonymous-function-declarations" class="toc-element">Anonymous function declarations</a></li>
<li><a href="expressions.pdf#lambda-literals" id="toc-element-lambda-literals" class="toc-element">Lambda literals</a></li>
</ul></li>
<li><a href="expressions.pdf#object-literals" id="toc-element-object-literals" class="toc-element">Object literals</a>
<ul>
<li><a href="expressions.pdf#functional-interface-lambda-literals" id="toc-element-functional-interface-lambda-literals" class="toc-element">Functional interface lambda literals</a></li>
</ul></li>
<li><a href="expressions.pdf#this-expressions" id="toc-element-this-expressions" class="toc-element">This-expressions</a></li>
<li><a href="expressions.pdf#super-forms" id="toc-element-super-forms" class="toc-element">Super-forms</a></li>
<li><a href="expressions.pdf#jump-expressions" id="toc-element-jump-expressions" class="toc-element">Jump expressions</a>
<ul>
<li><a href="expressions.pdf#throw-expressions" id="toc-element-throw-expressions" class="toc-element">Throw expressions</a></li>
<li><a href="expressions.pdf#return-expressions" id="toc-element-return-expressions" class="toc-element">Return expressions</a></li>
<li><a href="expressions.pdf#continue-expressions" id="toc-element-continue-expressions" class="toc-element">Continue expressions</a></li>
<li><a href="expressions.pdf#break-expressions" id="toc-element-break-expressions" class="toc-element">Break expressions</a></li>
</ul></li>
</ul></li>
<li><a href="operator-overloading.pdf#operator-overloading" id="toc-element-operator-overloading" class="toc-element">Operator overloading</a>
<ul>
<li><a href="operator-overloading.pdf#destructuring-declarations" id="toc-element-destructuring-declarations" class="toc-element">Destructuring declarations</a></li>
</ul></li>
<li><a href="packages-and-imports.pdf#packages-and-imports" id="toc-element-packages-and-imports" class="toc-element">Packages and imports</a>
<ul>
<li><a href="packages-and-imports.pdf#importing" id="toc-element-importing" class="toc-element">Importing</a></li>
<li><a href="packages-and-imports.pdf#modules" id="toc-element-modules" class="toc-element">Modules</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#overload-resolution" id="toc-element-overload-resolution" class="toc-element">Overload resolution</a>
<ul>
<li><a href="overload-resolution.pdf#glossary-3" id="toc-element-glossary-3" class="toc-element unnumbered">Glossary</a></li>
<li><a href="overload-resolution.pdf#introduction-4" id="toc-element-introduction-4" class="toc-element unnumbered">Introduction</a></li>
<li><a href="overload-resolution.pdf#receivers" id="toc-element-receivers" class="toc-element">Receivers</a></li>
<li><a href="overload-resolution.pdf#the-forms-of-call-expression" id="toc-element-the-forms-of-call-expression" class="toc-element">The forms of call-expression</a></li>
<li><a href="overload-resolution.pdf#callables-and-invoke-convention" id="toc-element-callables-and-invoke-convention" class="toc-element">Callables and <code>invoke</code> convention</a></li>
<li><a href="overload-resolution.pdf#c-level-partition" id="toc-element-c-level-partition" class="toc-element">c-level partition</a></li>
<li><a href="overload-resolution.pdf#building-the-overload-candidate-set-ocs" id="toc-element-building-the-overload-candidate-set-ocs" class="toc-element">Building the overload candidate set (OCS)</a>
<ul>
<li><a href="overload-resolution.pdf#fully-qualified-call" id="toc-element-fully-qualified-call" class="toc-element">Fully-qualified call</a></li>
<li><a href="overload-resolution.pdf#call-with-an-explicit-receiver" id="toc-element-call-with-an-explicit-receiver" class="toc-element">Call with an explicit receiver</a>
<ul>
<li><a href="overload-resolution.pdf#call-with-an-explicit-type-receiver" id="toc-element-call-with-an-explicit-type-receiver" class="toc-element">Call with an explicit type receiver</a></li>
<li><a href="overload-resolution.pdf#call-with-an-explicit-super-form-receiver" id="toc-element-call-with-an-explicit-super-form-receiver" class="toc-element">Call with an explicit super-form receiver</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#infix-function-call" id="toc-element-infix-function-call" class="toc-element">Infix function call</a></li>
<li><a href="overload-resolution.pdf#operator-call" id="toc-element-operator-call" class="toc-element">Operator call</a></li>
<li><a href="overload-resolution.pdf#call-without-an-explicit-receiver" id="toc-element-call-without-an-explicit-receiver" class="toc-element">Call without an explicit receiver</a></li>
<li><a href="overload-resolution.pdf#call-with-named-parameters" id="toc-element-call-with-named-parameters" class="toc-element">Call with named parameters</a></li>
<li><a href="overload-resolution.pdf#call-with-trailing-lambda-expressions" id="toc-element-call-with-trailing-lambda-expressions" class="toc-element">Call with trailing lambda expressions</a></li>
<li><a href="overload-resolution.pdf#call-with-specified-type-parameters" id="toc-element-call-with-specified-type-parameters" class="toc-element">Call with specified type parameters</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#determining-function-applicability-for-a-specific-call" id="toc-element-determining-function-applicability-for-a-specific-call" class="toc-element">Determining function applicability for a specific call</a>
<ul>
<li><a href="overload-resolution.pdf#rationale" id="toc-element-rationale" class="toc-element">Rationale</a></li>
<li><a href="overload-resolution.pdf#description" id="toc-element-description" class="toc-element">Description</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#choosing-the-most-specific-candidate-from-the-overload-candidate-set" id="toc-element-choosing-the-most-specific-candidate-from-the-overload-candidate-set" class="toc-element">Choosing the most specific candidate from the overload candidate set</a>
<ul>
<li><a href="overload-resolution.pdf#rationale-1" id="toc-element-rationale-1" class="toc-element">Rationale</a></li>
<li><a href="overload-resolution.pdf#algorithm-of-msc-selection" id="toc-element-algorithm-of-msc-selection" class="toc-element">Algorithm of MSC selection</a></li>
<li><a href="overload-resolution.pdf#using-lambda-return-type-to-refine-function-applicability" id="toc-element-using-lambda-return-type-to-refine-function-applicability" class="toc-element">Using lambda return type to refine function applicability</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#resolving-callable-references" id="toc-element-resolving-callable-references" class="toc-element">Resolving callable references</a>
<ul>
<li><a href="overload-resolution.pdf#resolving-callable-references-not-used-as-arguments-to-a-call" id="toc-element-resolving-callable-references-not-used-as-arguments-to-a-call" class="toc-element">Resolving callable references not used as arguments to a call</a></li>
<li><a href="overload-resolution.pdf#bidirectional-resolution-for-callable-calls" id="toc-element-bidirectional-resolution-for-callable-calls" class="toc-element">Bidirectional resolution for callable calls</a></li>
</ul></li>
<li><a href="overload-resolution.pdf#type-inference-and-overload-resolution" id="toc-element-type-inference-and-overload-resolution" class="toc-element">Type inference and overload resolution</a></li>
<li><a href="overload-resolution.pdf#conflicting-overloads" id="toc-element-conflicting-overloads" class="toc-element">Conflicting overloads</a></li>
</ul></li>
<li><a href="control--and-data-flow-analysis.pdf#control--and-data-flow-analysis" id="toc-element-control--and-data-flow-analysis" class="toc-element">Control- and data-flow analysis</a>
<ul>
<li><a href="control--and-data-flow-analysis.pdf#control-flow-graph" id="toc-element-control-flow-graph" class="toc-element">Control flow graph</a>
<ul>
<li><a href="control--and-data-flow-analysis.pdf#expressions-cdfa" id="toc-element-expressions-cdfa" class="toc-element">Expressions</a>
<ul>
<li><a href="control--and-data-flow-analysis.pdf#function-calls-and-operators" id="toc-element-function-calls-and-operators" class="toc-element">Function calls and operators</a></li>
<li><a href="control--and-data-flow-analysis.pdf#conditional-expressions-1" id="toc-element-conditional-expressions-1" class="toc-element">Conditional expressions</a></li>
<li><a href="control--and-data-flow-analysis.pdf#boolean-operators" id="toc-element-boolean-operators" class="toc-element">Boolean operators</a></li>
<li><a href="control--and-data-flow-analysis.pdf#other-expressions" id="toc-element-other-expressions" class="toc-element">Other expressions</a></li>
</ul></li>
<li><a href="control--and-data-flow-analysis.pdf#statements-cdfa" id="toc-element-statements-cdfa" class="toc-element">Statements</a></li>
<li><a href="control--and-data-flow-analysis.pdf#declarations-1" id="toc-element-declarations-1" class="toc-element">Declarations</a></li>
<li><a href="control--and-data-flow-analysis.pdf#examples" id="toc-element-examples" class="toc-element">Examples</a></li>
<li><a href="control--and-data-flow-analysis.pdf#kotlin.nothing-and-its-influence-on-the-cfg" id="toc-element-kotlin.nothing-and-its-influence-on-the-cfg" class="toc-element"><code>kotlin.Nothing</code> and its influence on the CFG</a></li>
</ul></li>
<li><a href="control--and-data-flow-analysis.pdf#performing-analyses-on-the-control-flow-graph" id="toc-element-performing-analyses-on-the-control-flow-graph" class="toc-element">Performing analyses on the control-flow graph</a>
<ul>
<li><a href="control--and-data-flow-analysis.pdf#preliminary-analysis-and-operatornamemathitkilldataflow-instruction" id="toc-element-preliminary-analysis-and-operatornamemathitkilldataflow-instruction" class="toc-element">Preliminary analysis and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal"><mrow><mi>k</mi><mi>i</mi><mi>l</mi><mi>l</mi><mi>D</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi>F</mi><mi>l</mi><mi>o</mi><mi>w</mi></mrow></mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">\operatorname{\mathit{killDataFlow}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop"><span class="mord"><span class="mord mathit">k</span><span class="mord mathit">i</span><span class="mord mathit">l</span><span class="mord mathit">l</span><span class="mord mathit">D</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">F</span><span class="mord mathit">l</span><span class="mord mathit">o</span><span class="mord mathit">w</span></span></span></span></span></span>

 instruction</a></li>
<li><a href="control--and-data-flow-analysis.pdf#variable-initialization-analysis" id="toc-element-variable-initialization-analysis" class="toc-element">Variable initialization analysis</a></li>
<li><a href="control--and-data-flow-analysis.pdf#smart-casting-analysis" id="toc-element-smart-casting-analysis" class="toc-element">Smart casting analysis</a></li>
<li><a href="control--and-data-flow-analysis.pdf#function-contracts" id="toc-element-function-contracts" class="toc-element">Function contracts</a></li>
</ul></li>
<li><a href="control--and-data-flow-analysis.pdf#references-1" id="toc-element-references-1" class="toc-element unnumbered">References</a></li>
</ul></li>
<li><a href="kotlin-type-constraints.pdf#kotlin-type-constraints" id="toc-element-kotlin-type-constraints" class="toc-element">Kotlin type constraints</a>
<ul>
<li><a href="kotlin-type-constraints.pdf#type-constraint-definition" id="toc-element-type-constraint-definition" class="toc-element">Type constraint definition</a></li>
<li><a href="kotlin-type-constraints.pdf#type-constraint-solving" id="toc-element-type-constraint-solving" class="toc-element">Type constraint solving</a>
<ul>
<li><a href="kotlin-type-constraints.pdf#checking-constraint-system-soundness" id="toc-element-checking-constraint-system-soundness" class="toc-element">Checking constraint system soundness</a>
<ul>
<li><a href="kotlin-type-constraints.pdf#a-sample-bound-inference-algorithm" id="toc-element-a-sample-bound-inference-algorithm" class="toc-element">A sample bound inference algorithm</a></li>
</ul></li>
<li><a href="kotlin-type-constraints.pdf#finding-optimal-constraint-system-solution" id="toc-element-finding-optimal-constraint-system-solution" class="toc-element">Finding optimal constraint system solution</a></li>
<li><a href="kotlin-type-constraints.pdf#the-relations-on-types-as-constraints" id="toc-element-the-relations-on-types-as-constraints" class="toc-element">The relations on types as constraints</a></li>
</ul></li>
</ul></li>
<li><a href="type-inference.pdf#type-inference" id="toc-element-type-inference" class="toc-element">Type inference</a>
<ul>
<li><a href="type-inference.pdf#smart-casts" id="toc-element-smart-casts" class="toc-element">Smart casts</a>
<ul>
<li><a href="type-inference.pdf#data-flow-framework" id="toc-element-data-flow-framework" class="toc-element">Data-flow framework</a>
<ul>
<li><a href="type-inference.pdf#smart-cast-lattices" id="toc-element-smart-cast-lattices" class="toc-element">Smart cast lattices</a></li>
<li><a href="type-inference.pdf#smart-cast-transfer-functions" id="toc-element-smart-cast-transfer-functions" class="toc-element">Smart cast transfer functions</a></li>
</ul></li>
<li><a href="type-inference.pdf#smart-cast-types" id="toc-element-smart-cast-types" class="toc-element">Smart cast types</a></li>
<li><a href="type-inference.pdf#smart-cast-sink-stability" id="toc-element-smart-cast-sink-stability" class="toc-element">Smart cast sink stability</a>
<ul>
<li><a href="type-inference.pdf#effectively-immutable-smart-cast-sinks" id="toc-element-effectively-immutable-smart-cast-sinks" class="toc-element">Effectively immutable smart cast sinks</a></li>
</ul></li>
<li><a href="type-inference.pdf#loop-handling" id="toc-element-loop-handling" class="toc-element">Loop handling</a></li>
<li><a href="type-inference.pdf#bound-smart-casts" id="toc-element-bound-smart-casts" class="toc-element">Bound smart casts</a></li>
</ul></li>
<li><a href="type-inference.pdf#local-type-inference" id="toc-element-local-type-inference" class="toc-element">Local type inference</a></li>
<li><a href="type-inference.pdf#function-signature-type-inference" id="toc-element-function-signature-type-inference" class="toc-element">Function signature type inference</a>
<ul>
<li><a href="type-inference.pdf#named-and-anonymous-function-declarations" id="toc-element-named-and-anonymous-function-declarations" class="toc-element">Named and anonymous function declarations</a></li>
<li><a href="type-inference.pdf#statements-with-lambda-literals" id="toc-element-statements-with-lambda-literals" class="toc-element">Statements with lambda literals</a></li>
</ul></li>
<li><a href="type-inference.pdf#bare-type-argument-inference" id="toc-element-bare-type-argument-inference" class="toc-element">Bare type argument inference</a></li>
</ul></li>
<li><a href="builder-style-type-inference.pdf#builder-style-type-inference" id="toc-element-builder-style-type-inference" class="toc-element">Builder-style type inference</a></li>
<li><a href="runtime-type-information.pdf#runtime-type-information" id="toc-element-runtime-type-information" class="toc-element">Runtime type information</a>
<ul>
<li><a href="runtime-type-information.pdf#runtime-available-types" id="toc-element-runtime-available-types" class="toc-element">Runtime-available types</a></li>
<li><a href="runtime-type-information.pdf#reflection" id="toc-element-reflection" class="toc-element">Reflection</a></li>
</ul></li>
<li><a href="exceptions.pdf#exceptions" id="toc-element-exceptions" class="toc-element">Exceptions</a>
<ul>
<li><a href="exceptions.pdf#catching-exceptions" id="toc-element-catching-exceptions" class="toc-element">Catching exceptions</a></li>
<li><a href="exceptions.pdf#throwing-exceptions" id="toc-element-throwing-exceptions" class="toc-element">Throwing exceptions</a></li>
</ul></li>
<li><a href="annotations.pdf#annotations" id="toc-element-annotations" class="toc-element">Annotations</a>
<ul>
<li><a href="annotations.pdf#annotation-values" id="toc-element-annotation-values" class="toc-element">Annotation values</a></li>
<li><a href="annotations.pdf#annotation-retention" id="toc-element-annotation-retention" class="toc-element">Annotation retention</a></li>
<li><a href="annotations.pdf#annotation-targets" id="toc-element-annotation-targets" class="toc-element">Annotation targets</a></li>
<li><a href="annotations.pdf#annotation-declarations" id="toc-element-annotation-declarations" class="toc-element">Annotation declarations</a></li>
<li><a href="annotations.pdf#built-in-annotations" id="toc-element-built-in-annotations" class="toc-element">Built-in annotations</a>
<ul>
<li><a href="annotations.pdf#kotlin.annotation.retention" id="toc-element-kotlin.annotation.retention" class="toc-element"><code>kotlin.annotation.Retention</code></a></li>
<li><a href="annotations.pdf#kotlin.annotation.target" id="toc-element-kotlin.annotation.target" class="toc-element"><code>kotlin.annotation.Target</code></a></li>
<li><a href="annotations.pdf#kotlin.annotation.repeatable" id="toc-element-kotlin.annotation.repeatable" class="toc-element"><code>kotlin.annotation.Repeatable</code></a></li>
<li><a href="annotations.pdf#kotlin.requiresoptin-kotlin.optin" id="toc-element-kotlin.requiresoptin-kotlin.optin" class="toc-element"><code>kotlin.RequiresOptIn</code> / <code>kotlin.OptIn</code></a></li>
<li><a href="annotations.pdf#kotlin.deprecated-kotlin.replacewith" id="toc-element-kotlin.deprecated-kotlin.replacewith" class="toc-element"><code>kotlin.Deprecated</code> / <code>kotlin.ReplaceWith</code></a></li>
<li><a href="annotations.pdf#kotlin.suppress" id="toc-element-kotlin.suppress" class="toc-element"><code>kotlin.Suppress</code></a></li>
<li><a href="annotations.pdf#kotlin.sincekotlin" id="toc-element-kotlin.sincekotlin" class="toc-element"><code>kotlin.SinceKotlin</code></a></li>
<li><a href="annotations.pdf#kotlin.unsafevariance" id="toc-element-kotlin.unsafevariance" class="toc-element"><code>kotlin.UnsafeVariance</code></a></li>
<li><a href="annotations.pdf#kotlin.dslmarker" id="toc-element-kotlin.dslmarker" class="toc-element"><code>kotlin.DslMarker</code></a></li>
<li><a href="annotations.pdf#kotlin.publishedapi" id="toc-element-kotlin.publishedapi" class="toc-element"><code>kotlin.PublishedApi</code></a></li>
<li><a href="annotations.pdf#kotlin.builderinference" id="toc-element-kotlin.builderinference" class="toc-element"><code>kotlin.BuilderInference</code></a></li>
<li><a href="annotations.pdf#kotlin.restrictsuspension" id="toc-element-kotlin.restrictsuspension" class="toc-element"><code>kotlin.RestrictSuspension</code></a></li>
<li><a href="annotations.pdf#kotlin.overloadresolutionbylambdareturntype" id="toc-element-kotlin.overloadresolutionbylambdareturntype" class="toc-element"><code>kotlin.OverloadResolutionByLambdaReturnType</code></a></li>
</ul></li>
</ul></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#asynchronous-programming-with-coroutines" id="toc-element-asynchronous-programming-with-coroutines" class="toc-element">Asynchronous programming with coroutines</a>
<ul>
<li><a href="asynchronous-programming-with-coroutines.pdf#suspending-functions" id="toc-element-suspending-functions" class="toc-element">Suspending functions</a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#coroutines" id="toc-element-coroutines" class="toc-element">Coroutines</a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#implementation-details" id="toc-element-implementation-details" class="toc-element">Implementation details</a>
<ul>
<li><a href="asynchronous-programming-with-coroutines.pdf#kotlin.coroutines.continuationt" id="toc-element-kotlin.coroutines.continuationt" class="toc-element"><code>kotlin.coroutines.Continuation&lt;T&gt;</code></a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#continuation-passing-style" id="toc-element-continuation-passing-style" class="toc-element">Continuation Passing Style</a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#coroutine-state-machine" id="toc-element-coroutine-state-machine" class="toc-element">Coroutine state machine</a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#continuation-interception" id="toc-element-continuation-interception" class="toc-element">Continuation interception</a></li>
<li><a href="asynchronous-programming-with-coroutines.pdf#coroutine-intrinsics" id="toc-element-coroutine-intrinsics" class="toc-element">Coroutine intrinsics</a></li>
</ul></li>
</ul></li>
<li><a href="concurrency.pdf#concurrency" id="toc-element-concurrency" class="toc-element">Concurrency</a></li>
</ul></li>
</ul>
</div>
<span style="visibility: hidden; counter-reset: chapter 18;"></span>
<h2 id="asynchronous-programming-with-coroutines">Asynchronous programming with coroutines</h2>

<h3 id="suspending-functions">Suspending functions</h3>
<div class="paragraph">
<p><span class="sentence">Most <a href="declarations.pdf#function-declaration">functions</a> in Kotlin may be marked <em>suspending</em> using the special <code>suspend</code> modifier. </span><span class="sentence">There are almost no additional restrictions: regular functions, extension functions, top-level functions, local functions, lambda literals, all these may be suspending functions.</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: the following functions and function values cannot be marked as suspending.</span></p>
</div>
<ul>
<li><span class="sentence"><a href="expressions.pdf#anonymous-function-declarations">anonymous function declarations</a>;</span></li>
<li><span class="sentence"><a href="declarations.pdf#class-declaration">constructors</a>;</span></li>
<li><span class="sentence"><a href="declarations.pdf#getters-and-setters">property getter/setters</a>;</span></li>
<li><span class="sentence"><a href="declarations.pdf#delegated-property-declaration">delegation-related operator functions</a>.</span></li>
</ul>
</blockquote>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: platform-specific implementations may extend the restrictions on which kinds of functions may be suspending.</span></p>
</div>
</blockquote>
<div class="paragraph">
<p><span class="sentence">Suspending functions have a <a href="type-system.pdf#suspending-function-types">suspending function type</a>, also marked using the <code>suspend</code> modifier.</span></p>
</div>

<div class="paragraph">
<p><span class="sentence">A suspending function is different from non-suspending functions by potentially having zero or more <em>suspension points</em> ‚Äî statements in its body which may pause the function execution to be resumed at a later moment in time. </span><span class="sentence">The main source of suspension points are calls to other suspending functions which represent possible suspension points.</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: suspension points are important because at these points another function may start in the same flow of execution, leading to potential changes in the shared state.</span></p>
</div>
</blockquote>
<div class="paragraph">
<p><span class="sentence">Non-suspending functions may not call suspending functions directly, as they do not support suspension points. </span><span class="sentence">Suspending functions may call non-suspending functions without any limitations; such calls do not create suspension points. </span><span class="sentence">This restriction is also known as <a href="https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/">‚Äúfunction colouring‚Äù</a>.</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Important: an exception to this rule are non-suspending inlined lambda parameters: if the higher-order function invoking such a lambda is called from a suspending function, this lambda is allowed to also have suspension points and call other suspending functions.</span></p>
</div>
</blockquote>

<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: suspending functions interleaving each other in this manner are not dissimilar to how functions from different threads interact on platforms with multi-threading support. </span><span class="sentence">There are, however, several key differences. </span><span class="sentence">First, suspending functions may pause only at suspension points, i.e., they cannot be paused at an arbitrary execution point. </span><span class="sentence">Second, this interleaving may happen on a single platform thread.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">In a multi-threaded environment suspending functions may also be interleaved by the platform-dependent concurrent execution, independent of the interleaving of coroutines.</span></p>
</div>
</blockquote>
<div class="paragraph">
<p><span class="sentence">The implementation of suspending functions is platform-dependent. </span><span class="sentence">Please refer to the platform documentation for details.</span></p>
</div>
<h3 id="coroutines">Coroutines</h3>
<div class="paragraph">
<p><span class="sentence">A <em>coroutine</em> is a concept similar to a thread in traditional concurrent programming, but based on <em>cooperative multitasking</em>, e.g., the switching between different execution contexts is done by the coroutines themselves rather than the operating system or a virtual machine.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">In Kotlin, coroutines are used to implement <a href="asynchronous-programming-with-coroutines.pdf#suspending-functions">suspending functions</a> and can switch contexts only at suspension points.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">A call to a suspending function creates and starts a coroutine. </span><span class="sentence">As one can call a suspending function only from another suspending function, we need a way to bootstrap this process from a non-suspending context.</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: this is required as most platforms are unaware of coroutines or suspending functions, and do not provide a suspending entry point. </span><span class="sentence">However, a Kotlin compiler may elect to provide a suspending entry point on a specific platform.</span></p>
</div>
</blockquote>
<div class="paragraph">
<p><span class="sentence">One of the ways of starting suspending function from a non-suspending context is via a <em>coroutine builder</em>: a non-suspending function which takes a suspending function type argument (e.g., a suspending lambda literal) and handles the coroutine lifecycle.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">The implementation of coroutines is platform-dependent. </span><span class="sentence">Please refer to the platform documentation for details.</span></p>
</div>
<h3 id="implementation-details">Implementation details</h3>
<div class="paragraph">
<p><span class="sentence">Despite being platform-dependent, there are several aspects of coroutine implementation in Kotlin, which are common across all platforms and belong to the Kotlin/Core. </span><span class="sentence">We describe these details below.</span></p>
</div>
<h4 id="kotlin.coroutines.continuationt"><code>kotlin.coroutines.Continuation&lt;T&gt;</code></h4>
<div class="paragraph">
<p><span class="sentence"><a href="declarations.pdf#interface-declaration">Interface</a> <code>kotlin.coroutines.Continuation&lt;T&gt;</code> is the main supertype of all coroutines and represents the basis upon which the coroutine machinery is implemented.</span></p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">public</span> <span class="kw">interface</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="kw">in</span> <span class="dt">T</span><span class="op">&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">    <span class="kw">public</span> <span class="kw">val</span> <span class="va">context</span><span class="op">:</span> <span class="dt">CoroutineContext</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">public</span> <span class="kw">fun</span> <span class="fu">resumeWith</span><span class="op">(</span><span class="va">result</span><span class="op">:</span> <span class="dt">Result</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;)</span></a>
<a class="sourceLine" id="cb1-4" title="4">}</a></code></pre></div>
<div class="paragraph">
<p><span class="sentence">Every suspending function is associated with a generated <code>Continuation</code> subtype, which handles the suspension implementation; the function itself is adapted to accept an additional continuation parameter to support the <a href="asynchronous-programming-with-coroutines.pdf#continuation-passing-style">Continuation Passing Style</a>. </span><span class="sentence">The return type of the suspending function becomes the type parameter <code>T</code> of the continuation.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence"><code>CoroutineContext</code> represents the context of the continuation and is an indexed set from <code>CoroutineContext.Key</code> to <code>CoroutineContext.Element</code> (e.g., a special kind of map). </span><span class="sentence">It is used to store coroutine-local information, and takes important part in [Coroutine interception].</span></p>
</div>
<div class="paragraph">
<p><span class="sentence"><code>resumeWith</code> function is used to propagate the results in between suspension points: it is called with the result (or exception) of the last suspension point and resumes the coroutine execution.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">To avoid the need to explicitly create the <code>Result&lt;T&gt;</code> when calling <code>resumeWith</code>, the coroutine implementation provides the following extension functions.</span></p>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">fun</span> <span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span> <span class="fu">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;.</span><span class="fu">resume</span><span class="op">(</span><span class="va">value</span><span class="op">:</span> <span class="dt">T</span><span class="op">)</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">fun</span> &lt;T&gt; Continuation&lt;T&gt;.resumeWithException(exception: Throwable)</a></code></pre></div>
<h4 id="continuation-passing-style">Continuation Passing Style</h4>
<div class="paragraph">
<p><span class="sentence">Each suspendable function goes through a transformation from normally invoked function to continuation passing style (CPS). </span><span class="sentence">For a suspendable function with parameters <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>p</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">p_1, p_2, \ldots, p_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>

 and result type <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>

 a new function is generated, with an additional parameter <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{N+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>

 of type <a href="asynchronous-programming-with-coroutines.pdf#kotlin.coroutines.continuationt"><code>kotlin.coroutines.Continuation&lt;T&gt;</code></a> and return type changed to <a href="built-in-types-and-their-semantics.pdf#kotlin.any-builtins"><code>kotlin.Any?</code></a>. </span><span class="sentence">The calling convention for such function is different from regular functions as a suspendable function may either <em>suspend</em> or <em>return</em>.</span></p>
</div>
<ul>
<li><span class="sentence">If the function returns a result, it is returned directly from the function as normal;</span></li>
<li><span class="sentence">If the function suspends, it returns a special marker value <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">COROUTINE_SUSPENDED</mtext><mrow></mrow></mrow><annotation encoding="application/x-tex">\texttt{COROUTINE\_SUSPENDED}{}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord text"><span class="mord texttt">COROUTINE_SUSPENDED</span></span><span class="mord"></span></span></span></span>

 to signal its suspended state.</span></li>
</ul>
<div class="paragraph">
<p><span class="sentence">The calling convention is maintained by the compiler during the CPS transformation, which prevents the user from manually returning <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">COROUTINE_SUSPENDED</mtext><mrow></mrow></mrow><annotation encoding="application/x-tex">\texttt{COROUTINE\_SUSPENDED}{}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord text"><span class="mord texttt">COROUTINE_SUSPENDED</span></span><span class="mord"></span></span></span></span>

. </span><span class="sentence">If the user wants to suspend a coroutine, they need to perform the following steps.</span></p>
</div>
<ul>
<li><span class="sentence">Access the coroutine‚Äôs continuation object by calling <a href="asynchronous-programming-with-coroutines.pdf#coroutine-intrinsics"><code>suspendCoroutineUninterceptedOrReturn</code> intrinsic</a> or any of its wrappers;</span></li>
<li><span class="sentence">Store the continuation object to resume it later;</span></li>
<li><span class="sentence">Pass the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">COROUTINE_SUSPENDED</mtext><mrow></mrow></mrow><annotation encoding="application/x-tex">\texttt{COROUTINE\_SUSPENDED}{}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord text"><span class="mord texttt">COROUTINE_SUSPENDED</span></span><span class="mord"></span></span></span></span>

 marker to the intrinsic, which is then returned from the function.</span></li>
</ul>
<div class="paragraph">
<p><span class="sentence">As Kotlin does not currently support denotable <a href="type-system.pdf#union-types">union types</a>, the return type is changed to <a href="built-in-types-and-their-semantics.pdf#kotlin.any-builtins"><code>kotlin.Any?</code></a>, so it can hold both the original return type <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>

 and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">COROUTINE_SUSPENDED</mtext><mrow></mrow></mrow><annotation encoding="application/x-tex">\texttt{COROUTINE\_SUSPENDED}{}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord text"><span class="mord texttt">COROUTINE_SUSPENDED</span></span><span class="mord"></span></span></span></span>

.</span></p>
</div>
<h4 id="coroutine-state-machine">Coroutine state machine</h4>
<div class="paragraph">
<p><span class="sentence">Kotlin implements suspendable functions as state machines, since such implementation does not require specific runtime support. </span><span class="sentence">This dictates the explicit <code>suspend</code> marking (function colouring) of Kotlin coroutines: the compiler has to know which function can potentially suspend, to turn it into a state machine.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">Each suspendable lambda is compiled to a continuation class, with fields representing its local variables, and an integer field for current state in the state machine. </span><span class="sentence">Suspension point is where such lambda can suspend: either a suspending function call or <a href="asynchronous-programming-with-coroutines.pdf#coroutine-intrinsics"><code>suspendCoroutineUninterceptedOrReturn</code> intrinsic</a> call. </span><span class="sentence">For a lambda with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>

 suspension points and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>

 return statements, which are not suspension points themselves, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>+</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N + M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>

 states are generated (one for each suspension point plus one for each non-suspending return statement).</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Example:</span></p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// Lambda body with multiple suspension points</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">val</span> <span class="va">a</span> <span class="op">=</span> a()</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">val</span> <span class="va">y</span> <span class="op">=</span> foo(a).await() <span class="co">// suspension point #1</span></a>
<a class="sourceLine" id="cb3-4" title="4">b()</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">val</span> <span class="va">z</span> <span class="op">=</span> bar(a, y).await() <span class="co">// suspension point #2</span></a>
<a class="sourceLine" id="cb3-6" title="6">c(z)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb4-1" title="1"><span class="co">// State machine code for the lambda after CPS transformation</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">//     (written in pseudo-Kotlin with gotos)</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">class</span> <span class="op">&lt;</span><span class="dt">anonymous</span><span class="op">&gt;</span> <span class="dt">private</span> <span class="kw">constructor</span>(</a>
<a class="sourceLine" id="cb4-4" title="4">    completion: Continuation&lt;<span class="kw">Any</span>?&gt;</a>
<a class="sourceLine" id="cb4-5" title="5">): SuspendLambda&lt;...&gt;(completion) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="co">// The current state of the state machine</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="kw">var</span> <span class="va">label</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb4-8" title="8">    </a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="co">// local variables of the coroutine</span></a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="kw">var</span> <span class="va">a</span><span class="op">:</span> <span class="dt">A?</span> <span class="op">=</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb4-11" title="11">    <span class="kw">var</span> <span class="va">y</span><span class="op">:</span> <span class="dt">Y?</span> <span class="op">=</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb4-12" title="12">    </a>
<a class="sourceLine" id="cb4-13" title="13">    <span class="kw">fun</span> <span class="fu">invokeSuspend</span><span class="op">(</span><span class="va">result</span><span class="op">:</span> <span class="dt">Any?</span><span class="op">):</span> <span class="dt">Any?</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-14" title="14">        <span class="co">// state jump table</span></a>
<a class="sourceLine" id="cb4-15" title="15">        <span class="cf">if</span> (label == <span class="dv">0</span>) goto L0</a>
<a class="sourceLine" id="cb4-16" title="16">        <span class="cf">if</span> (label == <span class="dv">1</span>) goto L1</a>
<a class="sourceLine" id="cb4-17" title="17">        <span class="cf">if</span> (label == <span class="dv">2</span>) goto L2</a>
<a class="sourceLine" id="cb4-18" title="18">        <span class="cf">else</span> <span class="kw">throw</span> IllegalStateException()</a>
<a class="sourceLine" id="cb4-19" title="19">        </a>
<a class="sourceLine" id="cb4-20" title="20">      L0:</a>
<a class="sourceLine" id="cb4-21" title="21">        <span class="co">// result is expected to be `null` at this invocation</span></a>
<a class="sourceLine" id="cb4-22" title="22">        </a>
<a class="sourceLine" id="cb4-23" title="23">        a = a()</a>
<a class="sourceLine" id="cb4-24" title="24">        label = <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-25" title="25">        <span class="co">// &#39;this&#39; is passed as a continuation </span></a>
<a class="sourceLine" id="cb4-26" title="26">        result = foo(a).await(<span class="kw">this</span>) </a>
<a class="sourceLine" id="cb4-27" title="27">        <span class="co">// return if await had suspended execution</span></a>
<a class="sourceLine" id="cb4-28" title="28">        <span class="cf">if</span> (result == COROUTINE_SUSPENDED)</a>
<a class="sourceLine" id="cb4-29" title="29">            <span class="kw">return</span> COROUTINE_SUSPENDED</a>
<a class="sourceLine" id="cb4-30" title="30">      L1:</a>
<a class="sourceLine" id="cb4-31" title="31">        <span class="co">// error handling</span></a>
<a class="sourceLine" id="cb4-32" title="32">        result.throwOnFailure()</a>
<a class="sourceLine" id="cb4-33" title="33">        <span class="co">// external code has resumed this coroutine</span></a>
<a class="sourceLine" id="cb4-34" title="34">        <span class="co">// passing the result of .await() </span></a>
<a class="sourceLine" id="cb4-35" title="35">        y = (Y) result</a>
<a class="sourceLine" id="cb4-36" title="36">        b()</a>
<a class="sourceLine" id="cb4-37" title="37">        label = <span class="dv">2</span></a>
<a class="sourceLine" id="cb4-38" title="38">        <span class="co">// &#39;this&#39; is passed as a continuation</span></a>
<a class="sourceLine" id="cb4-39" title="39">        result = bar(a, y).await(<span class="kw">this</span>)</a>
<a class="sourceLine" id="cb4-40" title="40">        <span class="co">// return if await had suspended execution</span></a>
<a class="sourceLine" id="cb4-41" title="41">        <span class="cf">if</span> (result == COROUTINE_SUSPENDED)</a>
<a class="sourceLine" id="cb4-42" title="42">            <span class="kw">return</span> COROUTINE_SUSPENDED</a>
<a class="sourceLine" id="cb4-43" title="43">      L2:</a>
<a class="sourceLine" id="cb4-44" title="44">        <span class="co">// error handling</span></a>
<a class="sourceLine" id="cb4-45" title="45">        result.throwOnFailure()</a>
<a class="sourceLine" id="cb4-46" title="46">        <span class="co">// external code has resumed this coroutine</span></a>
<a class="sourceLine" id="cb4-47" title="47">        <span class="co">// passing the result of .await()</span></a>
<a class="sourceLine" id="cb4-48" title="48">        Z z = (Z) result</a>
<a class="sourceLine" id="cb4-49" title="49">        c(z)</a>
<a class="sourceLine" id="cb4-50" title="50">        label = <span class="dv">-1</span> <span class="co">// No more steps are allowed</span></a>
<a class="sourceLine" id="cb4-51" title="51">        <span class="kw">return</span> <span class="kw">Unit</span></a>
<a class="sourceLine" id="cb4-52" title="52">    <span class="op">}</span>          </a>
<a class="sourceLine" id="cb4-53" title="53">    </a>
<a class="sourceLine" id="cb4-54" title="54">    <span class="kw">fun</span> <span class="fu">create</span><span class="op">(</span><span class="va">completion</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">Any?</span><span class="op">&gt;):</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">Any?</span><span class="op">&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-55" title="55">      &lt;anonymous&gt;(completion)</a>
<a class="sourceLine" id="cb4-56" title="56">    <span class="op">}</span>          </a>
<a class="sourceLine" id="cb4-57" title="57">    </a>
<a class="sourceLine" id="cb4-58" title="58">    <span class="kw">fun</span> <span class="fu">invoke</span><span class="op">(</span><span class="va">completion</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">Any?</span><span class="op">&gt;):</span> <span class="dt">Any?</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-59" title="59">        create(completion).invokeSuspend(<span class="kw">Unit</span>)</a>
<a class="sourceLine" id="cb4-60" title="60">    <span class="op">}</span></a>
<a class="sourceLine" id="cb4-61" title="61"><span class="op">}</span></a></code></pre></div>
</blockquote>
<h4 id="continuation-interception">Continuation interception</h4>
<div class="paragraph">
<p><span class="sentence">Asynchronous computations in many cases need to control how they are executed, with varying degrees of precision. </span><span class="sentence">For example, in typical user interface (UI) applications, updates to the interface should be executed on a special UI thread; in server-side applications, long-running computations are often offloaded to a separate thread pool, etc.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">Continuation interceptors allow us to intercept the coroutine execution between suspension points and perform some operations on it, usually wrapping the coroutine continuation in another continuation. </span><span class="sentence">This is done using the <code>kotlin.coroutines.ContinuationInterceptor</code> interface.</span></p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">interface</span> <span class="dt">ContinuationInterceptor</span> <span class="op">:</span> <span class="dt">CoroutineContext</span>.Element <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">    <span class="kw">companion</span> <span class="kw">object</span> <span class="dt">Key</span> <span class="op">:</span> <span class="dt">CoroutineContext</span>.Key&lt;ContinuationInterceptor&gt;</a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="kw">fun</span> <span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span> <span class="fu">interceptContinuation</span><span class="op">(</span><span class="va">continuation</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;):</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="kw">fun</span> releaseInterceptedContinuation(continuation: Continuation&lt;*&gt;)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="op">}</span></a></code></pre></div>
<div class="paragraph">
<p><span class="sentence">As seen from the declaration, <code>ContinuationInterceptor</code> is a <code>CoroutineContext.Element</code>, and to perform the continuation interception, an instance of <code>ContinuationInterceptor</code> should be available in the coroutine context, where it is used similarly to the following line of code.</span></p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">val</span> <span class="va">intercepted</span> <span class="op">=</span> continuation.context[ContinuationInterceptor]?.interceptContinuation(continuation) ?: continuation</a></code></pre></div>
<div class="paragraph">
<p><span class="sentence">When the cached <code>intercepted</code> continuation is no longer needed, it is released using <code>ContinuationInterceptor.releaseInterceptedContinuation(...)</code>.</span></p>
</div>
<blockquote>
<div class="paragraph">
<p><span class="sentence">Note: this machinery is performed ‚Äúbehind-the-scenes‚Äù by the coroutine framework implementation.</span></p>
</div>
</blockquote>
<h4 id="coroutine-intrinsics">Coroutine intrinsics</h4>
<div class="paragraph">
<p><span class="sentence">Accessing the low-level continuations is performed using a limited number of built-in intrinsic functions, which form the complete coroutine API. </span><span class="sentence">The rest of asynchronous programming support is provided as a Kotlin library <a href="https://github.com/Kotlin/kotlinx.coroutines"><code>kotlinx.coroutines</code></a>.</span></p>
</div>
<div class="paragraph">
<p><span class="sentence">The complete built-in API for working with coroutines is shown below (all of these are declared in package <code>kotlin.coroutines.intrinsics</code> of the standard library).</span></p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode kotlin"><code class="sourceCode kotlin"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">fun</span> <span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span> <span class="op">(</span><span class="va">suspend</span> (<span class="op">)</span> -&gt; <span class="fu">T</span>)<span class="op">.</span><span class="fu">createCoroutineUnintercepted</span><span class="op">(</span></a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="va">completion</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="op">):</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">Unit</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="fu">suspend</span> <span class="kw">fun</span> &lt;T&gt;</a>
<a class="sourceLine" id="cb7-6" title="6">    suspendCoroutineUninterceptedOrReturn(</a>
<a class="sourceLine" id="cb7-7" title="7">        block: (Continuation&lt;T&gt;) -&gt; <span class="kw">Any</span>?): T</a>
<a class="sourceLine" id="cb7-8" title="8"></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw">fun</span> <span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span> <span class="op">(</span><span class="va">suspend</span> (<span class="op">)</span> -&gt; <span class="fu">T</span>)<span class="op">.</span></a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="fu">startCoroutineUninterceptedOrReturn</span><span class="op">(</span></a>
<a class="sourceLine" id="cb7-11" title="11">        <span class="va">completion</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;):</span> <span class="dt">Any?</span></a>
<a class="sourceLine" id="cb7-12" title="12"></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="kw">fun</span> &lt;T&gt; Continuation&lt;T&gt;.intercepted(): Continuation&lt;T&gt;</a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">// Additional functions for types with explicit receiver</span></a>
<a class="sourceLine" id="cb7-16" title="16"></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="kw">fun</span> <span class="op">&lt;</span><span class="dt">R</span>, <span class="dt">T</span><span class="op">&gt;</span> <span class="op">(</span><span class="va">suspend</span> <span class="va">R</span>.(<span class="op">)</span> -&gt; <span class="fu">T</span>)<span class="op">.</span><span class="fu">createCoroutineUnintercepted</span><span class="op">(</span></a>
<a class="sourceLine" id="cb7-18" title="18">    <span class="va">completion</span><span class="op">:</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">T</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="op">):</span> <span class="dt">Continuation</span><span class="op">&lt;</span><span class="dt">Unit</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="kw">fun</span> &lt;T&gt; (suspend R.() -&gt; T).</a>
<a class="sourceLine" id="cb7-22" title="22">    startCoroutineUninterceptedOrReturn(</a>
<a class="sourceLine" id="cb7-23" title="23">        completion: Continuation&lt;T&gt;): <span class="kw">Any</span>?</a></code></pre></div>
<div class="paragraph">
<p><span class="sentence">Function <code>createCoroutineUnintercepted</code> is used to create a coroutine corresponding to its extension receiver suspending function, which invokes the passed <code>completion</code> continuation upon completion. </span><span class="sentence">This function does not start the coroutine, however; to do that, one have to call <code>Continuation&lt;T&gt;.resumeWith</code> function on the created continuation object. </span><span class="sentence">Suspending function <code>suspendCoroutineUninterceptedOrReturn</code> provides access to the current continuation (similarly to how <code>call/cc</code> works in Scheme). </span><span class="sentence">If its lambda returns the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">COROUTINE_SUSPENDED</mtext><mrow></mrow></mrow><annotation encoding="application/x-tex">\texttt{COROUTINE\_SUSPENDED}{}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord text"><span class="mord texttt">COROUTINE_SUSPENDED</span></span><span class="mord"></span></span></span></span>

 marker, it also suspends the coroutine. </span><span class="sentence">Together with <code>Continuation&lt;T&gt;.resumeWith</code> function, which resumes or starts a coroutine, these functions form a complete coroutine API built into the Kotlin compiler.</span></p>
</div>
</body>
</html>
